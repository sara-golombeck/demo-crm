# {{- if .Values.certManagerHook.enabled }}
# apiVersion: v1
# kind: ServiceAccount
# metadata:
#   name: {{ include "democrm.fullname" . }}-cert-manager-hook
#   annotations:
#     "helm.sh/hook": pre-install,pre-upgrade
#     "helm.sh/hook-weight": "-10"
#     "helm.sh/hook-delete-policy": hook-succeeded,before-hook-creation
# ---
# apiVersion: rbac.authorization.k8s.io/v1
# kind: ClusterRole
# metadata:
#   name: {{ include "democrm.fullname" . }}-cert-manager-hook
#   annotations:
#     "helm.sh/hook": pre-install,pre-upgrade
#     "helm.sh/hook-weight": "-10"
#     "helm.sh/hook-delete-policy": hook-succeeded,before-hook-creation
# rules:
#   - apiGroups: ["apiextensions.k8s.io"]
#     resources: ["customresourcedefinitions"]
#     verbs: ["create", "get", "update", "patch"]
# ---
# apiVersion: rbac.authorization.k8s.io/v1
# kind: ClusterRoleBinding
# metadata:
#   name: {{ include "democrm.fullname" . }}-cert-manager-hook
#   annotations:
#     "helm.sh/hook": pre-install,pre-upgrade
#     "helm.sh/hook-weight": "-10"
#     "helm.sh/hook-delete-policy": hook-succeeded,before-hook-creation
# roleRef:
#   apiGroup: rbac.authorization.k8s.io
#   kind: ClusterRole
#   name: {{ include "democrm.fullname" . }}-cert-manager-hook
# subjects:
#   - kind: ServiceAccount
#     name: {{ include "democrm.fullname" . }}-cert-manager-hook
#     namespace: {{ .Release.Namespace }}
# ---
# apiVersion: batch/v1
# kind: Job
# metadata:
#   name: {{ include "democrm.fullname" . }}-cert-manager-crds
#   annotations:
#     "helm.sh/hook": pre-install,pre-upgrade
#     "helm.sh/hook-weight": "-5"
#     "helm.sh/hook-delete-policy": hook-succeeded,before-hook-creation
# spec:
#   template:
#     spec:
#       serviceAccountName: {{ include "democrm.fullname" . }}-cert-manager-hook
#       restartPolicy: OnFailure
#       containers:
#       - name: install-crds
#         image: bitnami/kubectl:{{ .Values.certManagerHook.kubectlVersion | default "latest" }}
#         command:
#           - kubectl
#           - apply
#           - -f
#           - https://github.com/cert-manager/cert-manager/releases/download/{{ .Values.certManagerHook.version }}/cert-manager.crds.yaml
#   backoffLimit: 3
# {{- end }}